create schema if not exists	tablas_proyecto_final;
use tablas_proyecto_final;

CREATE TABLE STOCK (
IDCAR varchar(100),
COLOR VARCHAR(50) NOT NULL,
TRANSMISION VARCHAR(50) NOT NULL,
PRIMARY KEY(idcar)
);

INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FYgHlQAL','BLANCO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZ9CZQA1','BLANCO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZANxQAP','GRIS','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZCFMQA5','BLANCO','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZcXcQAL','NEGRO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZd6rQAD','ROJO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZeQdQAL','GRIS','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZI1aQAH','NEGRO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZiazQAD','BLANCO','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZIx0QAH','Plateado','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZKn3QAH','NEGRO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZLAbQAP','ROJO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZLJ8QAH','Plateado','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZnOyQAL','GRIS','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZofbQAD','NEGRO','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZPNKQA5','Azul','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZQS6QAP','NEGRO','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZU1xQAH','GRIS','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002FZUCCQA5','Plateado','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GvlefQAB','ROJO','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GvrJ0QAJ','ROJO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GvsFOQAZ','GRIS','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GvsLRQAZ','Azul','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002Gw4nhQAB','Plateado','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002Gw8cYQAR','GRIS','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002Gw9LdQAJ','BLANCO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwBGuQAN','ROJO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002Gwe9TQAR','GRIS','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwEO0QAN','ROJO','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwggjQAB','GRIS','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwIjqQAF','GRIS','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwKJLQA3','GRIS','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwM0sQAF','BLANCO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwMNNQA3','BLANCO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwmokQAB',' NEGRO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwnHEQAZ','ROJO','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwPUCQA3','BLANCO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwQkzQAF','NEGRO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwS8YQAV','GRIS','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwsfeQAB','BEIGE','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwsG0QAJ','Azul','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwsVUQAZ','NEGRO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwtXbQAJ','Azul','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwvKAQAZ','BLANCO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwxgtQAB','ROJO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002GwYL9QAN','NEGRO','MecÃ¡nica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002Gwzj6QAB','Plateado','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002Gx39sQAB','ROJO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002Gx3Z7QAJ','Plateado','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002Gx4W9QAJ','GRIS','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002Gx7ABQAZ','NEGRO','AutomÃ¡tica');
INSERT INTO `stock` (`IDCAR`, `COLOR`, `TRANSMISION`) VALUES ('0064X00002Gx7KMQAZ','BLANCO','AutomÃ¡tica');

/*drop table stock;*/
select * from stock;

CREATE TABLE LEADS (
idlead varchar(100),
idcar varchar(100),
fecha_creacion date,
PRIMARY KEY(idlead),
FOREIGN KEY (idcar) references STOCK(idcar)
);

INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('540','0064X00002FYgHlQAL','2023-03-02');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('733','0064X00002FYgHlQAL','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('926','0064X00002FYgHlQAL','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('539','0064X00002FZ9CZQA1','2023-03-02');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('732','0064X00002FZ9CZQA1','2023-03-03');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('925','0064X00002FZ9CZQA1','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('538','0064X00002FZANxQAP','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('731','0064X00002FZANxQAP','2023-03-09');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('924','0064X00002FZANxQAP','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('537','0064X00002FZCFMQA5','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('730','0064X00002FZCFMQA5','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('923','0064X00002FZCFMQA5','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('536','0064X00002FZcXcQAL','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('729','0064X00002FZcXcQAL','2023-03-04');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('922','0064X00002FZcXcQAL','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('535','0064X00002FZd6rQAD','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('728','0064X00002FZd6rQAD','2023-03-09');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('921','0064X00002FZd6rQAD','2023-03-03');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('534','0064X00002FZeQdQAL','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('727','0064X00002FZeQdQAL','2023-03-04');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('920','0064X00002FZeQdQAL','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('533','0064X00002FZI1aQAH','2023-03-09');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('726','0064X00002FZI1aQAH','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('919','0064X00002FZI1aQAH','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('532','0064X00002FZiazQAD','2023-03-09');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('725','0064X00002FZiazQAD','2023-03-03');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('918','0064X00002FZiazQAD','2023-03-04');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('531','0064X00002FZIx0QAH','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('724','0064X00002FZIx0QAH','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('917','0064X00002FZIx0QAH','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('530','0064X00002FZKn3QAH','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('723','0064X00002FZKn3QAH','2023-03-09');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('916','0064X00002FZKn3QAH','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('529','0064X00002FZLAbQAP','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('722','0064X00002FZLAbQAP','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('915','0064X00002FZLAbQAP','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('528','0064X00002FZLJ8QAH','2023-03-04');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('721','0064X00002FZLJ8QAH','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('914','0064X00002FZLJ8QAH','2023-03-09');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('527','0064X00002FZnOyQAL','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('720','0064X00002FZnOyQAL','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('913','0064X00002FZnOyQAL','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('526','0064X00002FZofbQAD','2023-03-03');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('719','0064X00002FZofbQAD','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('912','0064X00002FZofbQAD','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('525','0064X00002FZPNKQA5','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('718','0064X00002FZPNKQA5','2023-03-09');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('911','0064X00002FZPNKQA5','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('524','0064X00002FZQS6QAP','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('717','0064X00002FZQS6QAP','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('910','0064X00002FZQS6QAP','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('523','0064X00002FZU1xQAH','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('716','0064X00002FZU1xQAH','2023-03-09');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('909','0064X00002FZU1xQAH','2023-03-03');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('522','0064X00002FZUCCQA5','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('715','0064X00002FZUCCQA5','2023-03-04');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('908','0064X00002FZUCCQA5','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('521','0064X00002GvlefQAB','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('714','0064X00002GvlefQAB','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('907','0064X00002GvlefQAB','2023-03-04');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('520','0064X00002GvrJ0QAJ','2023-03-03');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('713','0064X00002GvrJ0QAJ','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('906','0064X00002GvrJ0QAJ','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('519','0064X00002GvsFOQAZ','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('712','0064X00002GvsFOQAZ','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('905','0064X00002GvsFOQAZ','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('518','0064X00002GvsLRQAZ','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('711','0064X00002GvsLRQAZ','2023-03-04');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('904','0064X00002GvsLRQAZ','2023-03-03');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('517','0064X00002Gw4nhQAB','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('710','0064X00002Gw4nhQAB','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('903','0064X00002Gw4nhQAB','2023-03-04');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('516','0064X00002Gw8cYQAR','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('709','0064X00002Gw8cYQAR','2023-03-04');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('902','0064X00002Gw8cYQAR','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('515','0064X00002Gw9LdQAJ','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('708','0064X00002Gw9LdQAJ','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('901','0064X00002Gw9LdQAJ','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('514','0064X00002GwBGuQAN','2023-03-09');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('707','0064X00002GwBGuQAN','2023-03-03');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('900','0064X00002GwBGuQAN','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('513','0064X00002Gwe9TQAR','2023-03-04');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('706','0064X00002Gwe9TQAR','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('899','0064X00002Gwe9TQAR','2023-03-03');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('511','0064X00002GwEO0QAN','2023-03-04');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('512','0064X00002GwEO0QAN','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('704','0064X00002GwEO0QAN','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('705','0064X00002GwEO0QAN','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('897','0064X00002GwEO0QAN','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('898','0064X00002GwEO0QAN','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('510','0064X00002GwggjQAB','2023-03-05');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('703','0064X00002GwggjQAB','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('896','0064X00002GwggjQAB','2023-03-09');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('509','0064X00002GwIjqQAF','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('702','0064X00002GwIjqQAF','2023-03-04');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('895','0064X00002GwIjqQAF','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('508','0064X00002GwKJLQA3','2023-03-06');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('701','0064X00002GwKJLQA3','2023-03-07');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('894','0064X00002GwKJLQA3','2023-03-08');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('507','0064X00002GwM0sQAF','2023-03-09');
INSERT INTO `leads` (`idlead`, `idcar`, `fecha_creacion`) VALUES ('700','0064X00002GwM0sQAF','2023-03-06');


select * from leads;
drop table leads;

CREATE TABLE EQUIPO_COMERCIAL (
idasesor INT,
FECHA_INGRESO DATE,
PRIMARY KEY(IDASESOR)
);


INSERT INTO `equipo_comercial` (`idasesor`, `FECHA_INGRESO`) VALUES (11170,'2023-03-01');
INSERT INTO `equipo_comercial` (`idasesor`, `FECHA_INGRESO`) VALUES (13019,'2023-03-20');
INSERT INTO `equipo_comercial` (`idasesor`, `FECHA_INGRESO`) VALUES (16583,'2023-03-01');
INSERT INTO `equipo_comercial` (`idasesor`, `FECHA_INGRESO`) VALUES (17555,'2023-01-01');


select * from equipo_comercial;
drop table equipo_comercial;

CREATE TABLE VISITAS (
idvisita INT,
site VARCHAR(50),
idasesor INT,
PRIMARY KEY(idvisita),
FOREIGN KEY (idasesor) references Equipo_comercial(idasesor)
);

INSERT INTO `visitas` (`idvisita`, `site`, `idasesor`) VALUES (201,'Lima',13019);
INSERT INTO `visitas` (`idvisita`, `site`, `idasesor`) VALUES (228,'Piura',13019);
INSERT INTO `visitas` (`idvisita`, `site`, `idasesor`) VALUES (240,'Piura',13019);
INSERT INTO `visitas` (`idvisita`, `site`, `idasesor`) VALUES (343,'Piura',13019);
INSERT INTO `visitas` (`idvisita`, `site`, `idasesor`) VALUES (358,'Piura',16583);
INSERT INTO `visitas` (`idvisita`, `site`, `idasesor`) VALUES (378,'Lima',16583);
INSERT INTO `visitas` (`idvisita`, `site`, `idasesor`) VALUES (381,'Lima',17555);

select * from visitas;
drop table visitas;

CREATE TABLE VENTAS (
idventa varchar(55),
PRICE_SALE FLOAT,
idcar varchar(100),
idasesor int,
PRIMARY KEY (idventa),
FOREIGN KEY (idcar) references STOCK (idcar),
FOREIGN KEY (idasesor) references equipo_comercial(idasesor)
);

drop table ventas;

select * from ventas;

INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-001B12F7',3250,'0064X00002GwtXbQAJ',11170);
INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-00208197',1272,'0064X00002FZUCCQA5',11170);
INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-003AA7D9',7750,'0064X00002GwIjqQAF',11170);
INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-003C8A7C',5200,'0064X00002Gw8cYQAR',16583);
INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-006A3D21',14040,'0064X00002GwggjQAB',16583);
INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-00925A4F',2850,'0064X00002FZUCCQA5',16583);
INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-00BE3F6B',12100,'0064X00002GvrJ0QAJ',16583);
INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-00C993E4',23770,'0064X00002FZofbQAD',13019);
INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-01532EEB',12570,'0064X00002FZQS6QAP',13019);
INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-01A0910C',21670,'0064X00002FYgHlQAL',13019);
INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-01A2052B',6000,'0064X00002FZLJ8QAH',17555);
INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-020BC6B4',15570,'0064X00002Gwe9TQAR',17555);
INSERT INTO `ventas` (`idventa`, `PRICE_SALE`, `idcar`, `idasesor`) VALUES ('P-0280D059',515,'0064X00002GwEO0QAN',17555);	


##Desafío_vistas

# Vista 1, tabla Stock: nro de leads generados por cada idcar en stock
CREATE OR REPLACE VIEW v_stock AS
(
select distinct s.idcar, count(s.IDCAR) as nro from stock as s
left join leads as l on s.idcar= l.idcar
group by s.IDCAR
order by nro desc);

#Vista 2, tabla equipo_comercial: nro de ventas generadas por cada asesor comercial
CREATE OR REPLACE VIEW v_equipo_comercial AS
(
SELECT eq.idasesor, count(v.idcar) as ventas_por_asesor FROM equipo_comercial as eq
left join ventas as v on eq.idasesor= v.idasesor
group by eq.idasesor);

#Vista 3, tabla leads: leads generados por dia
CREATE OR REPLACE VIEW v_leads as
(
SELECT fecha_creacion, count(idcar) 
FROM leads
group by fecha_creacion);

#Vista 4, tabla ventas:
CREATE OR REPLACE VIEW v_ventas as
(
select avg(price_sale) from ventas);

#Vista 5, tabla visitas:
CREATE OR REPLACE VIEW v_visitas as
(
select site, count(v.idasesor) as asesores_site from visitas as v
left join equipo_comercial as eq on v.idasesor= eq.idasesor
group by site)

#Desafío funciones

#Función 1
DROP FUNCTION modelar;
CREATE FUNCTION modelar (valor VARCHAR(100))
RETURNS VARCHAR(100)
DETERMINISTIC
RETURN(REPLACE(valor,'Ã¡','a'));

select modelar(transmision) from stock;

#Función 2
drop function ventas_max_asesor;

CREATE FUNCTION ventas_max_asesor (valorf INT)
RETURNS float
deterministic
return(
select count(idventa) as nro from equipo_comercial as eq
left join ventas as v on eq.idasesor=v.idasesor
group by eq.idasesor
order by nro desc
limit 1
)
#Ventas totales que ha tenido cada asesor comeciar y el número máximo de ventas que ha logrado alguno de ellos
select eq.idasesor, count(v.idventa) as ventas_totales, ventas_max_asesor(eq.idasesor) as venta_max_asesor from equipo_comercial eq
left join ventas v on eq.idasesor= v.idasesor
group by eq.idasesor;

## Desafío Creación de SP
#Desafío 1
DROP procedure insertar; 

DELIMITER $$
CREATE PROCEDURE ordenar(IN site_or, desc)
begin
	INSERT INTO visitas(idvisita, site, idasesor) values (nro_visita, lugar, asesor);
END $$
DELIMITER ;

call insertar(395,'Ica','17555');

SELECT * FROM VISITAS;


#Desafío SCRIPT DE CREACIÓN DE STORED PROCEDURES

## Ejercicio 1
--
DROP PROCEDURE ordenamiento;

DELIMITER //
CREATE PROCEDURE ordenamiento (IN site varchar(100), IN orden BOOLEAN)
--
BEGIN
	IF site <>"" AND orden=1 THEN
		SET @ordenar = concat("order by ", site);
	ELSEIF site <> "" AND orden=0 THEN
		SET @ordenar = concat("order by ", site, ' DESC');
	ELSE
		SET @ordenar = " ";
	END IF;
    SET @clausula_select = concat("SELECT * FROM VISITAS ",@ordenar);
    PREPARE ejecucion FROM @clausula_select;
EXECUTE ejecucion;
DEALLOCATE PREPARE ejecucion;
END //
DELIMITER ;

CALL ordenamiento("site",0);

## Ejercicio 2
DROP procedure insertar; 

DELIMITER $$
CREATE PROCEDURE insertar(IN nro_visita int, in lugar varchar(100), in asesor varchar(100))
begin
	INSERT INTO visitas(idvisita, site, idasesor) values (nro_visita, lugar, asesor);
END $$
DELIMITER ;

call insertar(395,'Ica','17555');

SELECT * FROM VISITAS;
